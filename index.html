<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hardini - Technology Meets Experiences</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸŒ±</text></svg>">
    <link rel="stylesheet" href="app.css">
    <link rel="stylesheet" href="hardini-auth.css">
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-database-compat.js"></script>
    <script src="firebase-config.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        firebase.initializeApp(firebaseConfig);
        firebase.auth().onAuthStateChanged(user => {
            if (!user) { window.location.href = 'login.html'; }
            else {
                const isGoogleUser = user.providerData.some(p => p.providerId === 'google.com');
                if (!user.emailVerified && !isGoogleUser) { window.location.href = 'login.html?unverified=true'; }
            }
        });
    </script>
</head>

<body>
    <!-- ===== SIDEBAR ===== -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <span class="sidebar-logo"><span>ğŸŒ±</span>HARDINI</span>
        </div>
        <nav class="sidebar-nav">
            <button class="nav-item active" data-page="home"><span class="nav-icon">ğŸ </span><span
                    class="nav-label">Home</span></button>
            <button class="nav-item" data-page="marketplace"><span class="nav-icon">ğŸ›’</span><span
                    class="nav-label">Marketplace</span></button>
            <button class="nav-item" data-page="supply-chain"><span class="nav-icon">ğŸ”—</span><span
                    class="nav-label">Supply Chain</span></button>
            <button class="nav-item" data-page="connect"><span class="nav-icon">ğŸ¤</span><span
                    class="nav-label">Connect</span></button>
            <button class="nav-item" data-page="reels"><span class="nav-icon">ğŸ¬</span><span
                    class="nav-label">AgriReels</span></button>
            <button class="nav-item" data-page="soilprobe"><span class="nav-icon">ğŸ“¡</span><span
                    class="nav-label">SoilProbe</span></button>
        </nav>
        <div class="sidebar-footer">
            <div class="profile-dropdown" id="profileDropdown">
                <button class="dropdown-item" onclick="openModal('editProfileModal')">ğŸ‘¤ Edit Profile</button>
                <button class="dropdown-item" onclick="openModal('ordersModal'); loadOrders();">ğŸ“¦ My Orders</button>
                <button class="dropdown-item" onclick="openModal('settingsModal')">âš™ï¸ Settings</button>
                <button class="dropdown-item danger" onclick="logout()">ğŸšª Logout</button>
            </div>
            <div class="sidebar-user" id="sidebarUser" onclick="toggleProfileDropdown()">
                <div class="user-avatar" id="userAvatarInitial">H</div>
                <div class="user-info">
                    <div class="user-name" id="userName">Hardini User</div>
                    <div class="user-email" id="userEmail">user@hardini.com</div>
                </div>
            </div>
        </div>
    </aside>

    <!-- ===== MOBILE BOTTOM NAV ===== -->
    <nav class="mobile-nav">
        <div class="mobile-nav-items">
            <button class="mobile-nav-item active" data-page="home"><span class="m-icon">ğŸ </span>Home</button>
            <button class="mobile-nav-item" data-page="marketplace"><span class="m-icon">ğŸ›’</span>Shop</button>
            <button class="mobile-nav-item" data-page="reels"><span class="m-icon">ğŸ¬</span>Reels</button>
            <button class="mobile-nav-item" data-page="connect"><span class="m-icon">ğŸ¤</span>Connect</button>
            <button class="mobile-nav-item" data-page="soilprobe"><span class="m-icon">ğŸ“¡</span>IoT</button>
        </div>
    </nav>

    <!-- ===== MAIN CONTENT ===== -->
    <main class="main-content">

        <!-- ===== HOME PAGE ===== -->
        <div class="page-view active" id="page-home">
            <div class="hero-banner">
                <h1>Welcome to Hardini ğŸŒ¾</h1>
                <h2>Technology Meets Experiences</h2>
                <p>Empowering farmers with AI-driven insights, IoT monitoring, and a complete marketplace for modern
                    agriculture.</p>
            </div>
            <div class="stat-grid">
                <div class="stat-card">
                    <div class="stat-number">50K+</div>
                    <div class="stat-label">Active Farmers</div>
                    <div class="stat-trend">â†‘ 12% this month</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">â‚¹2.5Cr</div>
                    <div class="stat-label">Marketplace Volume</div>
                    <div class="stat-trend">â†‘ 25% growth</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">1000+</div>
                    <div class="stat-label">IoT Devices</div>
                    <div class="stat-trend">â†‘ 8% connected</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">200+</div>
                    <div class="stat-label">Expert Mentors</div>
                    <div class="stat-trend">â†‘ 15 new this month</div>
                </div>
            </div>
            <h2 style="margin-bottom:20px">ğŸš€ Quick Actions</h2>
            <div class="card-grid" style="margin-bottom:32px">
                <div class="glass-card" style="cursor:pointer" onclick="navigateTo('marketplace')">
                    <div class="card-icon-lg">ğŸ›ï¸</div>
                    <div class="card-title">Shop Marketplace</div>
                    <div class="card-desc">Browse seeds, fertilizers, pesticides, equipment & drones at the best prices.
                    </div>
                </div>
                <div class="glass-card" style="cursor:pointer" onclick="toggleChatbot()">
                    <div class="card-icon-lg">ğŸ¤–</div>
                    <div class="card-title">AI Farm Assistant</div>
                    <div class="card-desc">Get instant answers on crop management, pest control, and farming techniques.
                    </div>
                </div>
                <div class="glass-card" style="cursor:pointer" onclick="navigateTo('soilprobe')">
                    <div class="card-icon-lg">ğŸ“¡</div>
                    <div class="card-title">Monitor Soil</div>
                    <div class="card-desc">Connect IoT sensors and track soil health in real-time from your devices.
                    </div>
                </div>
                <div class="glass-card" style="cursor:pointer" onclick="navigateTo('reels')">
                    <div class="card-icon-lg">ğŸ¬</div>
                    <div class="card-title">Watch AgriReels</div>
                    <div class="card-desc">Learn through short farming videos, tech demos, and expert tutorials.</div>
                </div>
            </div>
            <h2 style="margin-bottom:20px">ğŸŒŸ Featured Solutions</h2>
            <div class="solutions-grid">
                <div class="solution-card">
                    <div class="solution-icon">ğŸŒ¾</div>
                    <h4>Precision Agriculture</h4>
                    <p>Leverage AI and satellite data for optimized farming decisions.</p>
                    <div class="benefit-highlights"><span>ğŸ“Š Data Analytics</span><span>ğŸ›°ï¸ Satellite
                            Maps</span><span>ğŸ¤– AI Recommendations</span></div>
                    <ul class="solution-features">
                        <li>Crop health monitoring</li>
                        <li>Yield prediction models</li>
                        <li>Weather-based alerts</li>
                    </ul><button class="btn btn-primary btn-sm" onclick="navigateTo('soilprobe')">Explore â†’</button>
                </div>
                <div class="solution-card">
                    <div class="solution-icon">ğŸ’§</div>
                    <h4>Smart Irrigation</h4>
                    <p>Save water and boost yields with IoT-powered irrigation systems.</p>
                    <div class="benefit-highlights"><span>ğŸ’¦ 40% Water Saved</span><span>ğŸ“ˆ 25% Yield
                            Boost</span><span>âš¡ Auto Schedule</span></div>
                    <ul class="solution-features">
                        <li>Soil moisture sensors</li>
                        <li>Automated scheduling</li>
                        <li>Mobile control</li>
                    </ul><button class="btn btn-primary btn-sm" onclick="navigateTo('soilprobe')">Learn More â†’</button>
                </div>
                <div class="solution-card">
                    <div class="solution-icon">ğŸ”—</div>
                    <h4>Direct Market Access</h4>
                    <p>Connect directly with buyers and get fair prices for your produce.</p>
                    <div class="benefit-highlights"><span>ğŸ’° Better Prices</span><span>ğŸšš Direct Delivery</span><span>ğŸ“±
                            Mobile Orders</span></div>
                    <ul class="solution-features">
                        <li>Buyer matching</li>
                        <li>Price discovery</li>
                        <li>Quality grading</li>
                    </ul><button class="btn btn-primary btn-sm" onclick="navigateTo('supply-chain')">Get Started
                        â†’</button>
                </div>
            </div>
        </div>

        <!-- ===== MARKETPLACE PAGE ===== -->
        <div class="page-view" id="page-marketplace">
            <div class="page-header">
                <h1>ğŸ›’ Marketplace</h1>
                <p>Premium agricultural products at the best prices</p>
            </div>
            <div class="category-tabs" id="categoryTabs">
                <button class="category-tab active" data-cat="seeds">ğŸŒ± Seeds</button>
                <button class="category-tab" data-cat="pesticides">ğŸ§ª Pesticides</button>
                <button class="category-tab" data-cat="fertilizers">ğŸ§« Fertilizers</button>
                <button class="category-tab" data-cat="equipment">ğŸ”§ Equipment</button>
                <button class="category-tab" data-cat="drones">ğŸš Drones</button>
            </div>
            <div class="product-grid" id="productGrid"></div>
        </div>

        <!-- ===== SUPPLY CHAIN PAGE ===== -->
        <div class="page-view" id="page-supply-chain">
            <div class="page-header">
                <h1>ğŸ”— Supply Chain</h1>
                <p>From farm to fork â€” transparent and efficient</p>
            </div>
            <div class="chain-flow">
                <div class="chain-step">
                    <div class="chain-node" onclick="openChainDetail('farmers')"><span class="chain-emoji">ğŸ‘¨â€ğŸŒ¾</span>
                        <h3>Farmers</h3>
                        <ul class="chain-features">
                            <li>Direct sourcing</li>
                            <li>Fair pricing</li>
                            <li>Quality control</li>
                        </ul>
                    </div>
                </div>
                <div class="chain-arrow">â†’</div>
                <div class="chain-step">
                    <div class="chain-node" onclick="openChainDetail('processing')"><span class="chain-emoji">ğŸ­</span>
                        <h3>Processing</h3>
                        <ul class="chain-features">
                            <li>Quality testing</li>
                            <li>Packaging</li>
                            <li>Certification</li>
                        </ul>
                    </div>
                </div>
                <div class="chain-arrow">â†’</div>
                <div class="chain-step">
                    <div class="chain-node" onclick="openChainDetail('distribution')"><span
                            class="chain-emoji">ğŸšš</span>
                        <h3>Distribution</h3>
                        <ul class="chain-features">
                            <li>Cold chain logistics</li>
                            <li>Route optimization</li>
                            <li>Real-time tracking</li>
                        </ul>
                    </div>
                </div>
                <div class="chain-arrow">â†’</div>
                <div class="chain-step">
                    <div class="chain-node" onclick="openChainDetail('retail')"><span class="chain-emoji">ğŸª</span>
                        <h3>Retail</h3>
                        <ul class="chain-features">
                            <li>Quality assured</li>
                            <li>Best prices</li>
                            <li>Fresh delivery</li>
                        </ul>
                    </div>
                </div>
                <div class="chain-arrow">â†’</div>
                <div class="chain-step">
                    <div class="chain-node" onclick="openChainDetail('consumers')"><span class="chain-emoji">ğŸ‘¥</span>
                        <h3>Consumers</h3>
                        <ul class="chain-features">
                            <li>Farm-to-fork</li>
                            <li>Traceability</li>
                            <li>Satisfaction</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div style="margin-top:32px">
                <h2 style="margin-bottom:20px">ğŸ“Š Supply Chain Impact</h2>
                <div class="impact-stats">
                    <div class="stat-card">
                        <div class="stat-number">85%</div>
                        <div class="stat-label">Wastage Reduction</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">3x</div>
                        <div class="stat-label">Faster Delivery</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">40%</div>
                        <div class="stat-label">Cost Savings</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">100%</div>
                        <div class="stat-label">Traceability</div>
                    </div>
                </div>
            </div>
            <div style="margin-top:32px">
                <h2 style="margin-bottom:12px">ğŸ’¡ Success Stories</h2>
                <div class="story-card"><span class="farmer-name">Rajesh Kumar, Maharashtra</span>
                    <p>"Since joining Hardini's supply chain, my income has increased by 160%. The direct market access
                        eliminated middlemen entirely."</p>
                </div>
                <div class="story-card"><span class="farmer-name">Priya Sharma, Karnataka</span>
                    <p>"The cold chain logistics ensured my produce reaches markets fresh. Wastage dropped from 30% to
                        just 5%."</p>
                </div>
            </div>
        </div>

        <!-- ===== CONNECT PAGE ===== -->
        <div class="page-view" id="page-connect">
            <div class="page-header">
                <h1>ğŸ¤ Connect & Network</h1>
                <p>Build relationships, share knowledge, grow together</p>
            </div>
            <div class="connect-grid">
                <div class="glass-card">
                    <div class="card-icon-lg">ğŸ‘¨â€ğŸŒ¾</div>
                    <div class="card-title">Farmers Network</div>
                    <div class="card-desc">Connect with 50,000+ progressive farmers across India. Share experiences and
                        learn best practices.</div>
                    <div class="card-tags"><span class="card-tag">Peer Learning</span><span class="card-tag">Regional
                            Groups</span><span class="card-tag">Success Stories</span></div><button
                        class="btn btn-primary btn-sm" onclick="openConnectModal('farmers')">Join Network â†’</button>
                </div>
                <div class="glass-card">
                    <div class="card-icon-lg">ğŸ¢</div>
                    <div class="card-title">Suppliers Hub</div>
                    <div class="card-desc">Access verified suppliers for seeds, fertilizers, equipment, and more at
                        wholesale prices.</div>
                    <div class="card-tags"><span class="card-tag">Verified Sellers</span><span class="card-tag">Bulk
                            Pricing</span><span class="card-tag">Direct Contact</span></div><button
                        class="btn btn-primary btn-sm" onclick="openConnectModal('suppliers')">Find Suppliers â†’</button>
                </div>
                <div class="glass-card">
                    <div class="card-icon-lg">ğŸ“ˆ</div>
                    <div class="card-title">Market Connect</div>
                    <div class="card-desc">Get real-time market prices, connect with buyers, and sell your produce at
                        the best rates.</div>
                    <div class="card-tags"><span class="card-tag">Live Prices</span><span class="card-tag">Buyer
                            Matching</span><span class="card-tag">Price Alerts</span></div><button
                        class="btn btn-primary btn-sm" onclick="openConnectModal('market')">View Markets â†’</button>
                </div>
                <div class="glass-card">
                    <div class="card-icon-lg">ğŸ“</div>
                    <div class="card-title">Expert Panel</div>
                    <div class="card-desc">Book consultations with agricultural scientists, agronomists, and farming
                        technology experts.</div>
                    <div class="card-tags"><span class="card-tag">1-on-1 Sessions</span><span class="card-tag">Video
                            Calls</span><span class="card-tag">Free First Session</span></div><button
                        class="btn btn-primary btn-sm" onclick="openConnectModal('experts')">Book Expert â†’</button>
                </div>
                <div class="glass-card">
                    <div class="card-icon-lg">ğŸ“š</div>
                    <div class="card-title">Training Hub</div>
                    <div class="card-desc">Free courses on modern farming techniques, soil management, and agri-business
                        development.</div>
                    <div class="card-tags"><span class="card-tag">Video Courses</span><span
                            class="card-tag">Certificates</span><span class="card-tag">Offline Access</span></div>
                    <button class="btn btn-primary btn-sm" onclick="openConnectModal('training')">Start Learning
                        â†’</button>
                </div>
                <div class="glass-card">
                    <div class="card-icon-lg">ğŸ’¬</div>
                    <div class="card-title">Community Forum</div>
                    <div class="card-desc">Ask questions, share solutions, and participate in discussions on all things
                        agriculture.</div>
                    <div class="card-tags"><span class="card-tag">Q&A</span><span
                            class="card-tag">Discussion</span><span class="card-tag">Expert Answers</span></div><button
                        class="btn btn-primary btn-sm" onclick="openConnectModal('forum')">Join Discussion â†’</button>
                </div>
            </div>
        </div>

        <!-- ===== REELS PAGE ===== -->
        <div class="page-view" id="page-reels">
            <div class="page-header">
                <h1>ğŸ¬ AgriReels</h1>
                <p>Learn modern farming through short videos</p>
            </div>
            <div class="category-tabs" id="reelsTabs">
                <button class="category-tab active" data-query="modern farming techniques India">ğŸŒ¾ Farming</button>
                <button class="category-tab" data-query="agricultural technology drones India">ğŸš AgriTech</button>
                <button class="category-tab" data-query="organic farming India tips">ğŸŒ¿ Organic</button>
                <button class="category-tab" data-query="hydroponics vertical farming India">ğŸ’§ Hydroponics</button>
                <button class="category-tab" data-query="dairy farming India modern">ğŸ„ Dairy</button>
            </div>
            <div class="reels-grid" id="reelsGrid">
                <div class="loading-spinner"></div>
            </div>
        </div>

        <!-- ===== SOILPROBE PAGE ===== -->
        <div class="page-view" id="page-soilprobe">
            <div class="page-header">
                <h1>ğŸ“¡ SoilProbe IoT Monitor</h1>
                <p>Real-time soil health monitoring for your farm</p>
            </div>
            <div style="display:flex;gap:12px;margin-bottom:24px;flex-wrap:wrap">
                <button class="btn btn-primary" onclick="scanBLEDevices()">ğŸ“¡ Scan BLE Devices</button>
                <button class="btn btn-secondary" onclick="openModal('addDeviceModal')">â• Add Device Manually</button>
                <button class="btn btn-secondary" onclick="loadDevices()">ğŸ”„ Refresh</button>
            </div>
            <div class="device-grid" id="deviceGrid">
                <div class="empty-state"><span class="empty-icon">ğŸ“¡</span>
                    <h3>No devices yet</h3>
                    <p>Scan for BLE devices or add one manually to start monitoring.</p>
                </div>
            </div>
            <div class="chart-container" id="chartContainer" style="display:none">
                <h3 style="margin-bottom:16px">ğŸ“Š Sensor Data History</h3>
                <canvas id="sensorChart"></canvas>
            </div>
        </div>

    </main>

    <!-- ===== MODALS ===== -->

    <!-- Edit Profile Modal -->
    <div class="modal-overlay" id="editProfileModal">
        <div class="modal-panel">
            <div class="modal-header">
                <h2>ğŸ‘¤ Edit Profile</h2><button class="modal-close" onclick="closeModal('editProfileModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <form id="editProfileForm">
                    <div class="form-group"><label>Full Name</label><input type="text" id="editFullName"
                            class="form-input" placeholder="Enter your full name"></div>
                    <div class="form-group"><label>Phone Number</label><input type="tel" id="editPhone"
                            class="form-input" placeholder="Enter your phone number"></div>
                    <div class="form-group"><label>Farming Experience</label><select id="editFarmingExperience"
                            class="form-select">
                            <option value="">Select experience</option>
                            <option value="beginner">Beginner (< 1 year)</option>
                            <option value="intermediate">Intermediate (1-5 years)</option>
                            <option value="experienced">Experienced (5-10 years)</option>
                            <option value="expert">Expert (> 10 years)</option>
                        </select></div>
                    <div class="form-group"><label>User Type</label><select id="editUserType" class="form-select">
                            <option value="customer">Customer</option>
                            <option value="farmer">Farmer</option>
                            <option value="farmer-supplier">Farmer Supplier</option>
                        </select></div>
                    <div class="form-group"><label>Location</label><input type="text" id="editLocation"
                            class="form-input" placeholder="City, State"></div>
                    <div style="display:flex;gap:12px;justify-content:flex-end;margin-top:20px">
                        <button type="button" class="btn btn-secondary"
                            onclick="closeModal('editProfileModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save Changes</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Orders Modal -->
    <div class="modal-overlay" id="ordersModal">
        <div class="modal-panel">
            <div class="modal-header">
                <h2>ğŸ“¦ My Orders</h2><button class="modal-close" onclick="closeModal('ordersModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <div id="ordersLoading">
                    <div class="loading-spinner"></div>
                    <p style="text-align:center;color:var(--text-secondary)">Loading orders...</p>
                </div>
                <div id="ordersList"></div>
                <div id="noOrders" style="display:none">
                    <div class="empty-state"><span class="empty-icon">ğŸ“¦</span>
                        <h3>No orders yet</h3>
                        <p>Start exploring our marketplace!</p><button class="btn btn-primary"
                            onclick="closeModal('ordersModal'); navigateTo('marketplace')">Shop Now â†’</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal-overlay" id="settingsModal">
        <div class="modal-panel">
            <div class="modal-header">
                <h2>âš™ï¸ Settings</h2><button class="modal-close" onclick="closeModal('settingsModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="setting-section">
                    <h3>Notifications</h3>
                    <div class="setting-item"><label class="switch"><input type="checkbox" id="emailNotifications"
                                checked><span class="slider"></span></label>
                        <div class="setting-info"><span class="setting-label">Email Notifications</span><span
                                class="setting-desc">Receive order updates and promotions via email</span></div>
                    </div>
                    <div class="setting-item"><label class="switch"><input type="checkbox" id="smsNotifications"><span
                                class="slider"></span></label>
                        <div class="setting-info"><span class="setting-label">SMS Notifications</span><span
                                class="setting-desc">Get important alerts via SMS</span></div>
                    </div>
                </div>
                <div class="setting-section">
                    <h3>Privacy & Security</h3>
                    <div class="setting-item"><label class="switch"><input type="checkbox" id="profileVisibility"><span
                                class="slider"></span></label>
                        <div class="setting-info"><span class="setting-label">Profile Visibility</span><span
                                class="setting-desc">Make your profile visible to other farmers</span></div>
                    </div>
                </div>
                <div class="setting-section">
                    <h3>Language & Region</h3>
                    <div class="setting-item">
                        <div class="setting-info"><span class="setting-label">Language</span><span
                                class="setting-desc">Choose your preferred language</span></div><select
                            id="languageSelect" class="language-select">
                            <option value="en">English</option>
                            <option value="hi">à¤¹à¤¿à¤‚à¤¦à¥€ (Hindi)</option>
                            <option value="mr">à¤®à¤°à¤¾à¤ à¥€ (Marathi)</option>
                            <option value="te">à°¤à±†à°²à±à°—à± (Telugu)</option>
                        </select>
                    </div>
                </div>
                <div class="setting-section">
                    <h3>Account Management</h3>
                    <button class="btn btn-secondary btn-block" onclick="resetPassword()" style="margin-bottom:8px">ğŸ”‘
                        Reset Password</button>
                    <button class="btn btn-secondary btn-block" onclick="exportData()" style="margin-bottom:8px">ğŸ“Š
                        Export Data</button>
                    <button class="btn btn-danger btn-block" onclick="showDeleteAccountConfirmation()">ğŸ—‘ï¸ Delete
                        Account</button>
                </div>
                <div style="display:flex;gap:12px;justify-content:flex-end;margin-top:20px">
                    <button class="btn btn-secondary" onclick="closeModal('settingsModal')">Cancel</button>
                    <button class="btn btn-primary" onclick="saveSettings()">Save Settings</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Reset Password Modal -->
    <div class="modal-overlay" id="resetPasswordModal">
        <div class="modal-panel" style="max-width:480px">
            <div class="modal-header">
                <h2>ğŸ”‘ Reset Password</h2><button class="modal-close"
                    onclick="closeModal('resetPasswordModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <form id="resetPasswordForm">
                    <div class="form-group"><label>Current Password</label><input type="password" id="currentPassword"
                            class="form-input" required placeholder="Enter current password"></div>
                    <div class="form-group"><label>New Password</label><input type="password" id="newPassword"
                            class="form-input" required placeholder="Enter new password"><small
                            style="color:var(--text-muted);font-size:11px">Must be at least 8 characters</small></div>
                    <div class="form-group"><label>Confirm New Password</label><input type="password"
                            id="confirmNewPassword" class="form-input" required placeholder="Confirm new password">
                    </div>
                    <div style="display:flex;gap:12px;justify-content:flex-end;margin-top:20px">
                        <button type="button" class="btn btn-secondary"
                            onclick="closeModal('resetPasswordModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary">Update Password</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Delete Account Modal -->
    <div class="modal-overlay" id="deleteAccountModal">
        <div class="modal-panel" style="max-width:480px">
            <div class="modal-header">
                <h2>âš ï¸ Delete Account</h2><button class="modal-close"
                    onclick="closeModal('deleteAccountModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <div style="text-align:center;margin-bottom:20px"><span style="font-size:48px">ğŸš¨</span>
                    <h3 style="margin-top:12px">Are you sure?</h3>
                    <p style="color:var(--text-secondary);font-size:13px;margin-top:8px">This action cannot be undone.
                        All your data will be permanently deleted.</p>
                </div>
                <div
                    style="background:rgba(239,83,80,.08);border:1px solid rgba(239,83,80,.2);border-radius:var(--radius-sm);padding:16px;margin-bottom:16px">
                    <h4 style="font-size:13px;margin-bottom:8px;color:var(--danger)">What will be deleted:</h4>
                    <ul class="info-list">
                        <li>Your profile information</li>
                        <li>All order history</li>
                        <li>Saved items and preferences</li>
                        <li>Farm management data</li>
                    </ul>
                </div>
                <div class="form-group"><label style="display:flex;align-items:center;gap:8px;font-size:13px"><input
                            type="checkbox" id="deleteConfirmCheckbox"> I understand this action cannot be
                        undone</label></div>
                <div class="form-group"><label>Enter password to confirm:</label><input type="password"
                        id="deletePassword" class="form-input" placeholder="Your password"></div>
                <div style="display:flex;gap:12px;justify-content:flex-end;margin-top:20px">
                    <button class="btn btn-secondary" onclick="closeModal('deleteAccountModal')">Cancel</button>
                    <button class="btn btn-danger" onclick="deleteAccount()">Delete Account</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Device Modal -->
    <div class="modal-overlay" id="addDeviceModal">
        <div class="modal-panel" style="max-width:480px">
            <div class="modal-header">
                <h2>â• Add Device</h2><button class="modal-close" onclick="closeModal('addDeviceModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <form id="addDeviceForm">
                    <div class="form-group"><label>Device Name</label><input type="text" id="deviceName"
                            class="form-input" required placeholder="e.g., Field Sensor 1"></div>
                    <div class="form-group"><label>Device ID</label><input type="text" id="deviceId" class="form-input"
                            required placeholder="e.g., ESP32-XXXX"></div>
                    <div class="form-group"><label>Field/Location</label><input type="text" id="deviceField"
                            class="form-input" placeholder="e.g., North Field"></div>
                    <div style="display:flex;gap:12px;justify-content:flex-end;margin-top:20px">
                        <button type="button" class="btn btn-secondary"
                            onclick="closeModal('addDeviceModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary">Add Device</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Reel Player Modal -->
    <div class="reel-modal-bg" id="reelPlayerModal">
        <button class="reel-modal-close" onclick="closeReelPlayer()">Ã—</button>
        <div class="reel-modal-frame"><iframe id="reelPlayerFrame" src="" allowfullscreen allow="autoplay"></iframe>
        </div>
    </div>

    <!-- Connect: Farmers Modal -->
    <div class="modal-overlay" id="farmersModal">
        <div class="modal-panel">
            <div class="modal-header">
                <h2>ğŸ‘¨â€ğŸŒ¾ Farmers Network</h2><button class="modal-close"
                    onclick="closeModal('farmersModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="card-grid" id="farmersList"></div>
            </div>
        </div>
    </div>

    <!-- Connect: Suppliers Modal -->
    <div class="modal-overlay" id="suppliersModal">
        <div class="modal-panel">
            <div class="modal-header">
                <h2>ğŸ¢ Suppliers Hub</h2><button class="modal-close" onclick="closeModal('suppliersModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="card-grid" id="suppliersList"></div>
            </div>
        </div>
    </div>

    <!-- Connect: Market Modal -->
    <div class="modal-overlay" id="marketModal">
        <div class="modal-panel">
            <div class="modal-header">
                <h2>ğŸ“ˆ Market Connect</h2><button class="modal-close" onclick="closeModal('marketModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <h3 style="margin-bottom:16px">Live Market Prices</h3>
                <div style="overflow-x:auto;margin-bottom:24px">
                    <table style="width:100%;border-collapse:collapse;color:var(--text-secondary)">
                        <thead>
                            <tr style="border-bottom:1px solid var(--border-color);text-align:left">
                                <th style="padding:12px">Crop</th>
                                <th style="padding:12px">Price</th>
                                <th style="padding:12px">Trend</th>
                            </tr>
                        </thead>
                        <tbody id="marketPricesBody"></tbody>
                    </table>
                </div>
                <h3 style="margin-bottom:16px">Active Buyers</h3>
                <div class="card-grid" id="buyersList"></div>
            </div>
        </div>
    </div>

    <!-- Connect: Experts Modal -->
    <div class="modal-overlay" id="expertsModal">
        <div class="modal-panel">
            <div class="modal-header">
                <h2>ğŸ“ Expert Panel</h2><button class="modal-close" onclick="closeModal('expertsModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="card-grid" id="expertsList"></div>
            </div>
        </div>
    </div>

    <!-- Connect: Training Modal -->
    <div class="modal-overlay" id="trainingModal">
        <div class="modal-panel">
            <div class="modal-header">
                <h2>ğŸ“š Training Hub</h2><button class="modal-close" onclick="closeModal('trainingModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="card-grid" id="coursesList"></div>
            </div>
        </div>
    </div>

    <!-- Connect: Forum Modal -->
    <div class="modal-overlay" id="forumModal">
        <div class="modal-panel">
            <div class="modal-header">
                <h2>ğŸ’¬ Community Forum</h2><button class="modal-close" onclick="closeModal('forumModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <div style="margin-bottom:24px">
                    <button class="btn btn-primary btn-block"
                        onclick="showNotification('New discussion feature coming soon!')">â• Start New
                        Discussion</button>
                </div>
                <div class="card-grid" id="forumList" style="display:flex;flex-direction:column;gap:12px"></div>
            </div>
        </div>
    </div>

    <!-- Device Registration Wizard Modal -->
    <div class="wizard-overlay" id="wizardOverlay" onclick="closeRegistrationWizard()"></div>
    <div class="wizard-modal" id="wizardModal">
        <div class="wizard-header">
            <h2>ğŸ“¡ Register New Device</h2>
            <button class="wizard-close" onclick="closeRegistrationWizard()">Ã—</button>
        </div>
        <div class="wizard-steps">
            <div class="wizard-step active" data-step="1">
                <div class="step-circle">1</div>
                <span>Discover</span>
            </div>
            <div class="wizard-step-line"></div>
            <div class="wizard-step" data-step="2">
                <div class="step-circle">2</div>
                <span>Configure</span>
            </div>
            <div class="wizard-step-line"></div>
            <div class="wizard-step" data-step="3">
                <div class="step-circle">3</div>
                <span>Register</span>
            </div>
        </div>
        <!-- Step 1: Discover -->
        <div class="wizard-content" id="wizardStep1">
            <h3>ğŸ” Discover Your Device</h3>
            <p>Scan for nearby SoilProbe devices via Bluetooth, or enter the device ID manually.</p>
            <div class="discover-options">
                <div id="bleScanBtn" class="discover-btn" onclick="startSoilProbeBLEScan()">
                    <div class="discover-icon">ğŸ”µ</div>
                    <span>Scan via Bluetooth</span>
                    <small>Recommended for new devices</small>
                </div>
                <div class="discover-divider"><span>or</span></div>
                <div class="manual-entry">
                    <label for="manualDeviceId">Enter Device ID</label>
                    <input type="text" id="manualDeviceId" placeholder="e.g. soilprobe-abc123"
                        oninput="onManualIdInput()" />
                    <small>Find the ID on your device label or packaging</small>
                </div>
            </div>
            <div class="ble-results" id="bleResults" style="display:none;">
                <h4>ğŸ“¡ Found Devices</h4>
                <div class="ble-device-list" id="bleDeviceList"></div>
            </div>
            <div class="wizard-actions">
                <button class="wizard-btn secondary" onclick="closeRegistrationWizard()">Cancel</button>
                <button class="wizard-btn primary" id="step1Next" onclick="goToStep(2)" disabled>Next âœ</button>
            </div>
        </div>
        <!-- Step 2: Configure Connectivity -->
        <div class="wizard-content" id="wizardStep2" style="display:none;">
            <h3>ğŸ“¶ Configure Connectivity</h3>
            <p>Choose how your device connects to the internet.</p>
            <div class="connectivity-tabs">
                <button class="conn-tab active" onclick="selectConnectivity('wifi')">ğŸ“¡ WiFi</button>
                <button class="conn-tab" onclick="selectConnectivity('sim')">ğŸ“¶ SIM Card</button>
            </div>
            <div class="conn-config" id="wifiConfig">
                <div class="config-field">
                    <label for="wifiSsid">WiFi Network (SSID)</label>
                    <input type="text" id="wifiSsid" placeholder="Enter your WiFi network name" />
                </div>
                <div class="config-field">
                    <label for="wifiPassword">WiFi Password</label>
                    <input type="password" id="wifiPassword" placeholder="Enter WiFi password" />
                </div>
                <div class="config-note">
                    <span>â„¹ï¸</span> Credentials will be sent to the device over Bluetooth. Ensure device is nearby.
                </div>
            </div>
            <div class="conn-config" id="simConfig" style="display:none;">
                <div class="config-field">
                    <label for="simApn">APN (Access Point Name)</label>
                    <input type="text" id="simApn" placeholder="e.g. internet" value="internet" />
                </div>
                <div class="config-note">
                    <span>â„¹ï¸</span> Ensure a SIM card with data plan is inserted in the device.
                </div>
            </div>
            <div class="wizard-actions">
                <button class="wizard-btn secondary" onclick="goToStep(1)">â¬… Back</button>
                <button class="wizard-btn primary" onclick="goToStep(3)">Next âœ</button>
            </div>
        </div>
        <!-- Step 3: Register -->
        <div class="wizard-content" id="wizardStep3" style="display:none;">
            <h3>ğŸ“ Name & Register</h3>
            <p>Give your device a name and assign it to a field.</p>
            <div class="register-form">
                <div class="config-field">
                    <label for="deviceNameWizard">Device Name</label>
                    <input type="text" id="deviceNameWizard" placeholder="e.g. Field 1 - North Sensor" />
                </div>
                <div class="config-field">
                    <label for="fieldNameInput">Field / Location</label>
                    <input type="text" id="fieldNameInput" placeholder="e.g. Field 1" />
                </div>
                <div class="config-field">
                    <label for="cropType">Crop Type</label>
                    <select id="cropType">
                        <option value="">Select Crop</option>
                        <option value="wheat">ğŸŒ¾ Wheat</option>
                        <option value="rice">ğŸš Rice</option>
                        <option value="cotton">ğŸ§¶ Cotton</option>
                        <option value="corn">ğŸŒ½ Corn / Maize</option>
                        <option value="sugarcane">ğŸ‹ Sugarcane</option>
                        <option value="soybean">ğŸŒ± Soybean</option>
                        <option value="vegetables">ğŸ¥¦ Vegetables</option>
                        <option value="fruits">ğŸ Fruits</option>
                        <option value="other">ğŸŒ¿ Other</option>
                    </select>
                </div>
                <div class="registration-summary">
                    <h4>ğŸ“‹ Registration Summary</h4>
                    <div class="summary-row"><span>Device ID:</span> <strong id="summaryDeviceId">--</strong></div>
                    <div class="summary-row"><span>Connectivity:</span> <strong id="summaryConn">WiFi</strong></div>
                </div>
            </div>
            <div class="wizard-actions">
                <button class="wizard-btn secondary" onclick="goToStep(2)">â¬… Back</button>
                <button class="wizard-btn primary success" id="registerBtn" onclick="registerDevice()">
                    âœ… Register Device
                </button>
            </div>
        </div>
    </div>

    <!-- ===== CHATBOT FAB + PANEL ===== -->
    <button class="chatbot-fab" id="chatbotFab" onclick="toggleChatbot()">
        <span class="bot-icon">ğŸ¤–</span>
        <span class="close-icon">âœ•</span>
    </button>

    <div class="chatbot-panel" id="chatbotPanel">
        <div class="chat-hdr">
            <div class="chat-hdr-left">
                <div class="chat-hdr-avatar">ğŸŒ±</div>
                <div>
                    <div class="chat-hdr-title">Hardini AI</div>
                    <div class="chat-hdr-sub">Farm Assistant</div>
                </div>
            </div>
            <div class="chat-hdr-actions">
                <select id="chatLang" title="Language">
                    <option value="auto" selected>ğŸŒ Auto</option>
                    <option value="en">English</option>
                    <option value="hi">à¤¹à¤¿à¤‚à¤¦à¥€</option>
                    <option value="mr">à¤®à¤°à¤¾à¤ à¥€</option>
                    <option value="te">à°¤à±†à°²à±à°—à±</option>
                    <option value="ta">à®¤à®®à®¿à®´à¯</option>
                    <option value="kn">à²•à²¨à³à²¨à²¡</option>
                    <option value="pa">à¨ªà©°à¨œà¨¾à¨¬à©€</option>
                </select>
                <button onclick="toggleTTS()" id="ttsToggle" title="Text-to-Speech">ğŸ”ˆ</button>
                <button onclick="clearChat()" title="Clear Chat">ğŸ—‘ï¸</button>
            </div>
        </div>
        <div class="chat-quick">
            <button class="chat-chip" onclick="sendQuickChat('What crops should I plant this season?')">ğŸŒ¾
                Crops</button>
            <button class="chat-chip" onclick="sendQuickChat('How to protect crops from pests?')">ğŸ› Pests</button>
            <button class="chat-chip" onclick="sendQuickChat('Best fertilizers for wheat?')">ğŸ§« Fertilizer</button>
            <button class="chat-chip" onclick="sendQuickChat('Weather forecast for farming')">ğŸŒ¤ï¸ Weather</button>
            <button class="chat-chip" onclick="sendQuickChat('Organic farming tips')">ğŸŒ¿ Organic</button>
        </div>
        <div class="chat-msgs" id="chatMessages">
            <div class="chat-msg bot">
                <div class="msg-avatar">ğŸŒ±</div>
                <div class="msg-bubble">Hello! I'm your Hardini AI assistant. How can I help with your farming today? ğŸŒ¾
                </div>
            </div>
        </div>
        <div class="chat-img-preview" id="chatImgPreview"><img id="chatPreviewImg" src="" alt=""><button
                class="remove-img" onclick="removeChatImage()">âœ•</button></div>
        <div class="chat-input-bar">
            <input type="file" id="chatImageInput" accept="image/*" onchange="handleChatImage(event)">
            <button class="chat-action-btn" onclick="document.getElementById('chatImageInput').click()"
                title="Upload image">ğŸ“·</button>
            <button class="chat-action-btn" id="voiceBtn" onclick="toggleVoiceInput()" title="Voice input">ğŸ¤</button>
            <input type="text" id="chatInput" placeholder="Ask about farming..."
                onkeydown="if(event.key==='Enter')sendChatMessage()">
            <button class="chat-send-btn" onclick="sendChatMessage()">â¤</button>
        </div>
    </div>

    <!-- Notification container -->
    <div id="notificationContainer"></div>

    <script src="hardini-auth.js"></script>
    <script src="app.js"></script>
</body>

</html>